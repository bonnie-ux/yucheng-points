<!doctype html>
<html lang="zh-Hant">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>林昱橙點數任務制度（四年級）</title>

  <style>
    :root{
      --accent:#F8B7C8;  /* 粉紅色 */
      --text:#111;
      --muted:#666;
      --line:#ddd;
      --bg:#fff;
    }
    *{box-sizing:border-box}
    body{
      margin:0;
      font-family: system-ui, -apple-system, "Segoe UI",
                   "Noto Sans TC","Microsoft JhengHei", Arial, sans-serif;
      color:var(--text);
      background:#f6f6f6;
    }
    .app{max-width:1200px;margin:16px auto;padding:16px}
    .topbar{display:flex;gap:12px;flex-wrap:wrap;justify-content:space-between;margin-bottom:12px}
    .title h1{margin:0;font-size:20px}
    .title .sub{font-size:12px;color:var(--muted)}
    .controls{display:flex;gap:8px;flex-wrap:wrap;align-items:center}

    button,.pill,input{
      border:1px solid var(--line);
      background:#fff;
      padding:8px 10px;
      border-radius:10px;
      font-size:14px;
    }
    button{cursor:pointer}
    button.primary{background:var(--accent);border:none;font-weight:700}
    button.danger{background:#ffe0e0;border:none}
    .pill{display:flex;gap:6px;align-items:center}

    .grid{display:grid;grid-template-columns:1.1fr .9fr;gap:12px}
    .card{
      background:#fff;
      border:1px solid var(--line);
      border-top:4px solid var(--accent);
      border-radius:14px;
      padding:14px;
    }
    h2{margin:0 0 8px 0;font-size:16px}

    .task{
      display:grid;
      grid-template-columns:22px 1fr auto;
      gap:10px;
      padding:10px;
      border:1px solid var(--line);
      border-radius:12px;
      margin-bottom:8px;
    }
    .task input{width:18px;height:18px}
    .task .name{font-weight:700}
    .task .pts{font-weight:900}

    table{width:100%;border-collapse:collapse;font-size:13px}
    th,td{border:1px solid var(--line);padding:8px}
    th{background:#fafafa}

    @media print{
      .controls,button{display:none!important}
      @page{size:A4 landscape;margin:10mm}
    }
  </style>
</head>

<body>
<div class="app">

  <div class="topbar">
    <div class="title">
      <h1>林昱橙點數任務制度（四年級）</h1>
      <div class="sub">可勾選｜可累積｜可列印｜資料存在本機</div>
    </div>
    <div class="controls">
      <span class="pill">今日 <strong id="today">0</strong> 點</span>
      <span class="pill">累積 <strong id="total">0</strong> 點</span>
      <button class="primary" onclick="saveDay()">存成今日紀錄</button>
      <button class="danger" onclick="resetToday()">清空今日</button>
    </div>
  </div>

  <div class="grid">
    <div class="card">
      <h2>任務＋點數規則</h2>
      <div id="tasks"></div>
    </div>

    <div class="card">
      <h2>點數紀錄</h2>
      <table>
        <thead>
          <tr><th>日期</th><th>摘要</th><th>點數</th><th>操作</th></tr>
        </thead>
        <tbody id="logs"></tbody>
      </table>
    </div>
  </div>
</div>

<script>
const KEY="yucheng_orange_v1";
const TASKS=[
 ["完成每日作息（照表走）",2],
 ["作業完成（不拖延）",2],
 ["運動 300 下",2],
 ["其它運動（有動就算）",1],
 ["牛奶 500cc",1],
 ["吃飯 30 分鐘內完成",1],
 ["外勞叫後 3 分鐘內起床",1],
 ["睡覺快速（提醒一次內上床）",1],
 ["沖鼻子＋刷牙＋拜拜＋換睡衣（30 分鐘）",2],
 ["閱讀或複習 20 分鐘",2],
 ["預習隔天課程 10–15 分鐘",1],
 ["整理書包／房間",1],
 ["情緒穩定、不頂嘴一天",1],
 ["幫忙家事一項",1]
];

let state=JSON.parse(localStorage.getItem(KEY))||{today:[],logs:[],total:0};

const tasksEl=document.getElementById("tasks");
const todayEl=document.getElementById("today");
const totalEl=document.getElementById("total");
const logsEl=document.getElementById("logs");

function render(){
  tasksEl.innerHTML="";
  let today=0;
  TASKS.forEach((t,i)=>{
    const checked=state.today.includes(i);
    if(checked) today+=t[1];
    tasksEl.innerHTML+=`
      <div class="task">
        <input type="checkbox" ${checked?"checked":""}
          onchange="toggle(${i})">
        <div class="name">${t[0]}</div>
        <div class="pts">+${t[1]}</div>
      </div>`;
  });
  todayEl.textContent=today;
  totalEl.textContent=state.total;

  logsEl.innerHTML="";
  state.logs.forEach((l,i)=>{
    logsEl.innerHTML+=`
      <tr>
        <td>${l.date}</td>
        <td>${l.text}</td>
        <td>${l.pts}</td>
        <td><button onclick="del(${i})">刪除</button></td>
      </tr>`;
  });
}

function toggle(i){
  if(state.today.includes(i))
    state.today=state.today.filter(x=>x!==i);
  else state.today.push(i);
  save();
}

function saveDay(){
  let pts=0,txt=[];
  state.today.forEach(i=>{
    pts+=TASKS[i][1];
    txt.push(TASKS[i][0]);
  });
  if(!pts)return;
  state.logs.unshift({
    date:new Date().toISOString().slice(0,10),
    text:txt.join("；"),
    pts
  });
  state.total+=pts;
  state.today=[];
  save();
}

function resetToday(){
  state.today=[];
  save();
}

function del(i){
  state.total-=state.logs[i].pts;
  state.logs.splice(i,1);
  save();
}

function save(){
  localStorage.setItem(KEY,JSON.stringify(state));
  render();
}

render();
</script>
</body>
</html>
